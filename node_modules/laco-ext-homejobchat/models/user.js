'use strict';

const mongoose = require('mongoose');
const autoIncrement = require('mongoose-auto-increment');
const helper = lacoLib('libs/helper');
const db = require('./db');

db.schemas.user = new mongoose.Schema({
    userid: {
        type: Number,
        required: [true, 'UserID is required'],
        unique: true
    },
    username: {
        type: String,
        required: [true, 'Username is required'],
    },
    type: {
        type: String,
        required: [true, 'Type is required'],
    },
    fullname: String,
    image: String,
    created_date: {
        type: Date,
        default: Date.now
    },
    updated_date: {
        type: Date,
        default: Date.now
    },
});

db.schemas.user.index({
    userid: 1,
    username: 1
}, {
    weights: {
        userid: 10,
        username: 8
    },
    name: 'userIndex'
});

db.schemas.user.plugin(autoIncrement.plugin, {
    model: 'users',
    field: 'intId',
    startAt: 1,
    incrementBy: 1
});

db.models.user = mongoose.model('users', db.schemas.user);