'use strict';

const _ = require('lodash');
const BasedEventEmitter = require('events').EventEmitter;

class EventEmitter extends BasedEventEmitter {
    constructor() {
        super();
        this.setMaxListeners(0);
    }

    all(events, callback) {
        if (!_.isArray(events)) {
            events = events.split(',');
        }
        let eventList = events.slice(0);
        events.forEach(event => {
            this.on(event, () => {
                let index = eventList.indexOf(event);
                if (index === -1) return;
                eventList.splice(index, 1);
                if (eventList.length === 0) {
                    return callback();
                }
            });
        });
    }

    any(events, callback) {
        events.forEach(event => {
            this.on(event, () => {
                if (events !== null) return callback();
                events = null;
            });
        });
    }
}

module.exports = EventEmitter;