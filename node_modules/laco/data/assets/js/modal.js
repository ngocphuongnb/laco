function isFunction(functionToCheck) {
    var getType = {};
    return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';
}
var LacoModal = function(settings) {
    this.selector = settings.selector;
    this.type = settings.type;
    this.content = settings.content || '';
    this.src = settings.src || '';
    this.element = $(settings.selector);
    this.init();
    this.listener();
}

LacoModal.totalModals = 0;
LacoModal.randomId = function() {
    var x = 10000000000;
    var rand = Math.floor(Math.random()*x) + 1;
    return `${new Date().getTime()}-${rand}`;
}

LacoModal.prototype.init = function() {
    this.modalId = LacoModal.randomId();
}

LacoModal.prototype.listener = function() {
    var self = this;
    $(document).on('click', this.selector, function(e) {
        e.preventDefault();
        LacoModal.totalModals++;
        self.template();
    });
}

LacoModal.prototype.template = function() {
    var self = this;
    var modalContent = '';
    if(self.type == 'iframe') {
        var iframeSrc = self.src;
        if(isFunction(self.src)) iframeSrc = self.src(self.element);
        modalContent = `<iframe src="${iframeSrc}" width="100%" height="100%" class="modal-iframe"></iframe>`;
    }
    var modalTpl = `
        <div class="laco-modal-holder" id="laco-modal-${this.modalId}">
            <div class="laco-modal">
                <div class="laco-modal-content">
                    <div class="laco-modal-frame">
                        <div class="laco-modal-header"><h1>Insert Media<span class="dashicons dashicons-arrow-down"></span></h1></div>
                        <div class="laco-modal-content">
                            ${modalContent}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="laco-modal-overlay" id="laco-modal-overlay-${this.modalId}"></div>`;
    
    $('body').addClass('laco-modal-activated');
    $('body').append(modalTpl);
    setTimeout(function() {
        $('.laco-modal').addClass('active');
    }, 100);
    this.modal = $(`#laco-modal-${this.modalId}`);
    this.overlay = $(`#laco-modal-overlay-${this.modalId}`);

    this.overlay.on('click', function(e) {        
        e.preventDefault();
        LacoModal.totalModals--;
        $('.laco-modal', this.modal).removeClass('active');
        $('.laco-modal-overlay', this.modal).animate({opacity: 0}, 100, function() {
            self.overlay.remove();
            self.modal.remove();
            if(LacoModal.totalModals == 0) $('body').removeClass('laco-modal-activated');
        });
    });
}