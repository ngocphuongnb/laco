if(void 0===window.HJChat){function HJLogger(t){this.name="HJLogger","object"==typeof t&&Object.assign(this,t)}function HJChat(t){if("undefined"==typeof jQuery&&this.logger("jQuery is required for HJChat to run..."),"undefined"==typeof io&&this.logger("SocketIO is required for HJChat to run..."),void 0!==t&&"object"!=typeof t)return this.logger.error("Invalid options:",t);this.options=Object.assign(this.options,t)}HJLogger.prototype.info=function(t,o){},HJLogger.prototype.warn=function(t,o){},HJLogger.prototype.error=function(t,o){throw new Error("["+this.name+" "+t+" "+JSON.stringify(o))},HJChat.logger=new HJLogger({name:"HJChatLogger"}),HJChat.prototype.logger=new HJLogger({name:"HJChat"}),HJChat.prototype.options={"socket.host":window.location.origin,"socket.path":"/socket","socket.resource":"/socket","ui.conversation.trigger":".hjchat-conversation-trigger","ui.conversation.trigger_id_prefix":"hjdicussionitem-","ui.conversation.user_info":function(t,o){},"ui.conversation.load_msg":function(t,o){},"ui.conversation.wrapper":".hjchat-msg-wrapper","ui.conversation.template":".hjchat-msg-template","ui.conversation.item_class":"hjchat-conversation-item","ui.conversation.id_prefix":"hj-conversation-","ui.form":"form.hjchat-form","ui.form.input":".hjchat-input","ui.msg.list":".hjchat-msgs","ui.msg.template":"<li>@msg</li>"},HJChat.prototype.config=function(t){if("object"!=typeof t)return this.logger.error("[Config] Invalid options:",t);this.options=Object.assign(this.options,t)},HJChat.prototype.socket=null,HJChat.prototype.events={},HJChat.prototype.loadedConversations={},HJChat.prototype.isLoadedConversation=function(t){return!!this.loadedConversations[t]},HJChat.prototype.init=function(){var t=this;$(this.options["ui.conversation.template"]).length&&$(this.options["ui.conversation.template"]).hide(),this.socket=io(this.options["socket.host"],{path:this.options["socket.path"],resource:this.options["socket.resource"]}),this.socket.on("connect",function(){t.listen()})},HJChat.prototype.listen=function(){var n=this,t=window.location.hash.replace("#","");t&&this.openConversation(t),$(document).on("click",this.options["ui.conversation.trigger"],function(t){var o=$(this).data("identity")||$(this).attr("id").replace(n.options["ui.conversation.trigger_id_prefix"],"");t.preventDefault(),n.openConversation(o)}),$(document).on("submit",this.options["ui.form"],function(t){t.preventDefault();var o=$(n.options["ui.form.input"],$(this)),i=o.val(),e=$(this).data("identity");return e?(i&&n.socket.emit(n.events.CREATE_CHAT_MSG,{identity:e,msg:i}),o.val(""),!1):n.logger.error("Invalid chat identity")}),n.socket.on(n.events.NEW_CHAT_MSG,function(t){var o=t.msg,i=t.identity;"string"==typeof n.options["ui.msg.template"]&&(o=n.options["ui.msg.template"].replace(/@msg/g,o)),"function"==typeof n.options["ui.msg.template"]&&(o=n.options["ui.msg.template"](o)),$("#"+n.options["ui.conversation.id_prefix"]+i+" "+n.options["ui.msg.list"]).append(o)})},HJChat.prototype.openConversation=function(t,o){if($(this.options["ui.form"]).data("identity",t),window.location.hash.replace("#","")!=t&&(window.location.hash="#"+t),!this.isLoadedConversation(t)){this.socket.emit("identity",t);var i=$(this.options["ui.conversation.template"]).clone();i.attr("id",this.options["ui.conversation.id_prefix"]+t),i.addClass(this.options["ui.conversation.item_class"]),i.removeClass(this.options["ui.conversation.template"].replace(/[\.#]/g,"")),$(this.options["ui.conversation.wrapper"]).append(i),this.options["ui.conversation.user_info"](t,i),this.options["ui.conversation.load_msg"](t,i),this.loadedConversations[t]=!0}$("."+this.options["ui.conversation.item_class"]).hide(),$("#"+this.options["ui.conversation.id_prefix"]+t).show(),$(this.options["ui.conversation.trigger"]).removeClass("active"),$('[data-identity="'+t+'"]').addClass("active"),$(this.options["ui.conversation.trigger_id_prefix"]+t).addClass("active"),$(this.options["ui.form.input"],$(this.options["ui.form"])).focus()}}
"use strict";var HJChatEvents={CREATE_CHAT_MSG:"create_chat_msg",NEW_CHAT_MSG:"new_chat_msg"};"undefined"!=typeof window&&"undefined"!=HJChat&&(HJChat.prototype.events=Object.assign(HJChat.prototype.events,HJChatEvents)),"object"==typeof exports&&(exports.ChatEvents=HJChatEvents);
$(function(){(new HJChat).init()});